/* app/static/style.css  (fs-28)
   - 修复 Chrome 全屏下 overlay 被 <video> 遮挡：明确 z-index 分层 + :fullscreen 兼容处理
   - 修正若干拼写：justify-content / line-height / min-width
*/

/* ===== 基础 ===== */
:root { color-scheme: light; }
* { box-sizing: border-box; }
html, body { height:100%; overflow-x:hidden; }
body {
  margin:0; background:#ffffff !important; color:#222;
  font-family: system-ui, -apple-system, "PingFang SC", "Microsoft Yahei", sans-serif;
}
button { cursor:pointer; }
a.link { color:#0059c9; text-decoration:none; }
a.link:hover { text-decoration:underline; }

/* ===== 顶部（手机不超宽，自动换行） ===== */
.topbar {
  position: sticky; top:0; z-index:10;
  background:#f7f7f7; padding:10px;
  display:flex; flex-wrap:wrap; gap:8px;
  border-bottom:1px solid #e6e6e6; overflow:hidden;
}
.crumb { font-weight:600; color:#333; flex:1 1 auto; min-width:0; word-break:break-all; }
.controls { margin-left:auto; display:flex; flex-wrap:wrap; gap:6px; align-items:center; flex:1 1 100%; min-width:0; }
.controls > * { min-width:0; }
.controls input[type=search], .controls select, .controls button {
  padding:6px 10px; background:#fff; border:1px solid #d0d0d0; border-radius:6px; color:#222;
}
.controls input[type=search] { flex:1 1 60%; }
.controls select { flex:1 1 40%; }
@media (min-width: 720px) {
  .controls { flex:0 0 auto; }
  .controls input[type=search] { min-width:160px; flex:0 0 auto; } /* 修正：min-width */
  .controls select { flex:0 0 auto; }
}

/* ===== 提示条 ===== */
.notice { background:#fff5e6; border:1px solid #ffd199; color:#663c00; padding:10px 12px; margin:10px; border-radius:8px; }

/* ===== 网格 ===== */
.grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap:12px; padding:14px; user-select:none; width:100%; }
@media (max-width: 640px) { .grid { grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px; padding:10px; } }

/* ===== 统一 tile ===== */
img { -webkit-user-drag:none; user-select:none; -webkit-touch-callout:none; }
.tile {
  position:relative; display:flex; flex-direction:column;
  border:1px solid #e2e2e2; border-radius:12px; overflow:hidden;
  background:#fff; transition: box-shadow .12s ease, transform .12s ease; cursor:pointer;
}
.tile:hover { box-shadow: 0 4px 14px rgba(0,0,0,.08); }
.tile .thumb { position:relative; width:100%; aspect-ratio:1/1; background:#f0f0f0; }
.tile .thumb img { width:100%; height:100%; object-fit:cover; display:block; }
.tile.folder .thumb { display:flex; align-items:center; justify-content:center; }
.tile.folder .big { font-size:48px; line-height:1; }
.tile .title{
  padding:8px 10px 4px; font-size:13px; line-height:1.35; color:#222;
  display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; min-height:2.7em;
}
.tile .meta{
  padding:0 10px 10px; font-size:12px; color:#555; opacity:.9;
  height:16px; line-height:16px; /* 修正：line-height */
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
@media (max-width:640px){ .tile .meta{ display:none; } }

/* 三点菜单 */
.tile .tile-menu{
  position:absolute; top:8px; right:8px;
  width:28px; height:28px; border:none; border-radius:14px;
  background:rgba(255,255,255,.42); color:#222;
  display:flex; align-items:center; justify-content:center; font-size:18px;
  box-shadow:0 1px 4px rgba(0,0,0,.12);
}
.tile .tile-menu:hover{ background:rgba(255,255,255,.62); }

/* ✅ 已完成徽标（左上角带圈勾） */
.status-badge{
  position:absolute; z-index:3;
  top:8px; left:8px;
  width:22px; height:22px; border-radius:22px;
  border:2px solid rgba(0,0,0,.35);
  background:rgba(255,255,255,.92);
  color:#0b7d0b; font-weight:700; font-size:14px; line-height:18px;
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
  opacity:0; transform:scale(.9);
  transition: opacity .15s ease, transform .15s ease;
}
.status-badge.done{ opacity:1; transform:scale(1); }

/* 选中/动画 */
.tile.selected { border-color:#00aaff; box-shadow: 0 0 0 2px rgba(0,170,255,.35) inset; }
@keyframes pulseZoom { 0%{transform:scale(1);} 60%{transform:scale(1.04);} 100%{transform:scale(1);} }
.tile.pulse { animation: pulseZoom .18s ease-out; }

/* 骨架屏 */
.skeleton { border:1px solid #eee; border-radius:12px; overflow:hidden; background:#fff; }
.skel-thumb { aspect-ratio:1/1; background:linear-gradient(90deg,#f2f2f2,#ececec,#f2f2f2); background-size:200% 100%; animation: skel 1.1s infinite; }
.skel-line { height:12px; margin:10px; border-radius:6px; background:#efefef; }
@keyframes skel { 0%{background-position:200% 0;} 100%{background-position:-200% 0;} }

/* 右键菜单 */
.ctxmenu{ position:fixed; z-index:1000; min-width:210px; background:#fff; border:1px solid #e0e0e0; border-radius:8px; box-shadow:0 10px 24px rgba(0,0,0,.12); overflow:hidden; }
.ctxmenu .item{ padding:10px 12px; font-size:14px; color:#222; cursor:pointer; white-space:nowrap; }
.ctxmenu .item:hover{ background:#f0f6ff; }
.ctxmenu .sep{ height:1px; background:#efefef; margin:4px 0; }

/* 框选 */
.rubber{
  position:fixed; z-index:900; border:2px solid rgba(0,170,255,.9);
  background: rgba(0,170,255,.13); pointer-events:none;
}

/* ===============================
   全屏播放器容器 + 分层（关键修复）
   =============================== */
.playerfs{
  position:fixed; left:0; top:0; width:100vw; height:100vh; background:#000;
  z-index:1200; display:flex; align-items:center; justify-content:center; /* 修正：justify-content */
}
/* 让 video 成为明确的较低层（避免合成层把兄弟元素盖住） */
.playerfs video{
  position:absolute; left:0; top:0; width:100vw; height:100vh;
  object-fit:contain; z-index:10;
  background:#000;
}
/* 覆盖层容器始终在 video 之上 */
.overlay{
  position:absolute; left:0; top:0; width:100vw; height:100vh;
  pointer-events:none; z-index:20;
}

/* 遮罩与控件层次（overlay 上的按钮要再高一些） */
.icon-btn{
  pointer-events:auto; position:fixed; top:14px; width:38px; height:38px; border-radius:38px;
  background:rgba(255,255,255,.75); color:#111; border:none; font-size:18px;
  display:flex; align-items:center; justify-content:center; box-shadow:0 2px 10px rgba(0,0,0,.2);
  opacity:.85; transition:opacity .2s ease; z-index:30; /* 提升到 overlay 之上 */
}
.icon-btn:hover{ opacity:1; }
.icon-btn.back{ left:14px; }
.icon-btn.menu{ right:14px; }
.playerfs.idle .icon-btn{ opacity:0; }

/* 遮罩与播放列表再往上叠 */
.shade{
  position:fixed; left:0; top:0; width:100%; height:100%;
  background: rgba(0,0,0,.25);
  pointer-events:auto;
  z-index:32;
  touch-action:none;
  overscroll-behavior: contain;
}
.shade.hidden{ display:none; }

/* ✅ 居中模态播放列表 */
.playlist{
  position:fixed; left:50%; transform:translateX(-50%);
  top:60px; bottom:14px;
  width:28vw; max-width:420px;
  pointer-events:auto;
  background:rgba(255,255,255,.96); border:1px solid #ddd; border-radius:10px;
  box-shadow:0 8px 24px rgba(0,0,0,.18); display:flex; flex-direction:column; overflow:hidden;
  z-index:33;
}
.playlist.hidden{ display:none; }
@media (min-width: 1024px){
  .playlist{ width:360px; }
}
.plist-header{ padding:10px 12px; font-weight:600; border-bottom:1px solid #eee; background:#fafafa; }
#plist{ list-style:none; margin:0; padding:0; overflow:auto; }
#plist li{ display:flex; gap:8px; align-items:center; padding:8px 12px; border-bottom:1px solid #f1f1f1; cursor:pointer; }
#plist li:hover{ background:#f4f8ff; }
#plist li.active{ background:#e8f3ff; }
#plist .dot{ width:8px; height:8px; border-radius:8px; background:#bbb; }
#plist li.active .dot{ background:#007fff; }

/* 播放列表弹出期间，彻底禁用视频的指针与触摸手势 */
.playerfs.locked{ touch-action:none; overscroll-behavior:contain; }
.playerfs.locked video{ pointer-events:none; }

/* 无限滚动状态条 & 触底哨兵 */
.inf-status{ text-align:center; padding:12px 10px; color:#666; font-size:13px; }
.sentinel{ width:100%; height:1px; }

/* ===============================
   ▶︎ Chrome 全屏兼容：:fullscreen / :-webkit-full-screen
   强制 overlay/按钮/列表 在最顶层
   =============================== */
#playerFS:fullscreen,
#playerFS:-webkit-full-screen{
  z-index:2147483638; /* 远高于页面其它层 */
}
#playerFS:fullscreen video,
#playerFS:-webkit-full-screen video{
  z-index:10;
}
#playerFS:fullscreen .overlay,
#playerFS:-webkit-full-screen .overlay{
  z-index:20;
}
#playerFS:fullscreen .icon-btn,
#playerFS:-webkit-full-screen .icon-btn{
  z-index:30;
}
#playerFS:fullscreen .shade,
#playerFS:-webkit-full-screen .shade{
  z-index:32;
}
#playerFS:fullscreen .playlist,
#playerFS:-webkit-full-screen .playlist{
  z-index:33;
}